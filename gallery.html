<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>写真ギャラリー - 焼津市役所BIRDERクラブ</title>
    <link rel="stylesheet" href="style.css">
    <script src="auth.js" defer></script>
    <script src="script.js" defer></script>
</head>
<body>
    <header>
        <div class="container">
            <h1><i class="icon">🦅</i>焼津市役所BIRDERクラブ</h1>
            <button class="mobile-menu-toggle" onclick="toggleMobileMenu()" aria-label="メニューを開く">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <nav id="main-nav">
                <ul>
                    <li><a href="index.html">ホーム</a></li>
                    <li><a href="gallery.html" class="active">写真ギャラリー</a></li>
                    <li><a href="records.html">活動記録</a></li>
                    <li><a href="birds.html">観察記録</a></li>
                    <li><a href="quiz.html">鳥クイズ</a></li>
                    <li><a href="games.html">ミニゲーム</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section class="page-hero">
            <div class="container">
                <h1>📸 写真ギャラリー</h1>
                <p>メンバーが撮影した野鳥たちをご紹介します</p>
            </div>
        </section>

        <section class="gallery">
            <div class="container">
                <h2>写真投稿</h2>
                
                <!-- 投稿方法選択タブ -->
                <div class="upload-tabs">
                    <button class="tab-btn active" onclick="switchUploadTab('direct')">直接アップロード</button>
                    <button class="tab-btn" onclick="switchUploadTab('form')">Googleフォーム</button>
                </div>

                <!-- 直接アップロードフォーム -->
                <div class="photo-upload-form" id="directUploadForm">
                    <h3>📸 写真を投稿する</h3>
                    <div class="form-group">
                        <label for="photoFiles">写真（複数選択可能）</label>
                        <div class="file-upload-area" id="photoUploadArea">
                            <div class="upload-icon">📁</div>
                            <p>クリックして写真を選択またはドラッグ＆ドロップ</p>
                            <input type="file" id="photoFiles" accept="image/*" multiple style="display: none;">
                        </div>
                        <div id="photoPreview" class="photo-preview-container"></div>
                    </div>
                    <div class="form-group">
                        <label for="photoTitle">写真タイトル</label>
                        <input type="text" id="photoTitle" placeholder="例：焼津港のカモメ" required>
                    </div>
                    <div class="form-group">
                        <label for="photoDescription">説明・撮影場所</label>
                        <textarea id="photoDescription" placeholder="撮影場所や状況について" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="photographerName">撮影者名</label>
                        <input type="text" id="photographerName" placeholder="お名前">
                    </div>
                    <div class="form-group">
                        <label for="shotDate">撮影日時</label>
                        <input type="datetime-local" id="shotDate">
                    </div>
                    <button id="uploadPhotoBtn" type="button" onclick="uploadPhotos()">📸 写真を投稿</button>
                </div>

                <!-- Googleフォーム投稿セクション -->
                <div class="google-form-section" id="googleFormSection" style="display: none;">
                    <h3>📱 Googleフォームで投稿</h3>
                    <div class="form-info">
                        <p>スマートフォンから簡単に写真を投稿できます。</p>
                        <p>以下のリンクからGoogleフォームを開いて写真をアップロードしてください。</p>
                    </div>
                    
                    <div class="google-form-actions">
                        <a href="https://docs.google.com/forms/d/e/1FAIpQLSdrektwIDfetljw0PHkbriutwehKfrRRJye8B5AVHpq1lIe0A/viewform?usp=dialog" 
                           target="_blank" class="google-form-btn">
                            📝 Googleフォームで投稿する
                        </a>
                        <button onclick="fetchFromSpreadsheet()" class="fetch-btn">
                            🔄 新しい投稿をチェック
                        </button>
                    </div>
                    
                    <div id="fetchStatus" class="fetch-status"></div>
                    
                    <!-- 自動チェック設定 -->
                    <div class="auto-check-section">
                        <h4>自動チェック設定</h4>
                        <div class="auto-check-controls">
                            <button onclick="startAutoCheck()" class="auto-btn">
                                ▶️ 自動チェック開始
                            </button>
                            <button onclick="stopAutoCheck()" class="auto-btn">
                                ⏹️ 自動チェック停止
                            </button>
                        </div>
                        <p class="auto-check-info">自動チェックを有効にすると、5分おきに新しい投稿をチェックします。</p>
                    </div>

                    <!-- 手動投稿追加フォーム -->
                    <div class="manual-add-section">
                        <h4>手動追加（管理者用）</h4>
                        <div class="form-group">
                            <label for="googleImageUrl">画像URL（Google Drive）</label>
                            <input type="url" id="googleImageUrl" placeholder="https://drive.google.com/file/d/...">
                        </div>
                        <div class="form-group">
                            <label for="googlePhotoTitle">タイトル</label>
                            <input type="text" id="googlePhotoTitle" placeholder="写真のタイトル">
                        </div>
                        <div class="form-group">
                            <label for="googlePhotoDescription">説明</label>
                            <textarea id="googlePhotoDescription" placeholder="撮影場所や状況について" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="googlePhotographer">撮影者名</label>
                            <input type="text" id="googlePhotographer" placeholder="撮影者名">
                        </div>
                        <button onclick="addGoogleFormPhoto()" class="add-btn">
                            ➕ 手動で写真を追加
                        </button>
                    </div>
                </div>

                <h2>投稿された写真</h2>
                
                <div class="photos-container" id="photosContainer">
                    <p class="no-photos">まだ写真が投稿されていません。</p>
                </div>
            </div>
        </section>

    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 焼津市役所BIRDERクラブ All rights reserved.</p>
            <p>野鳥を愛し、自然を守る仲間たち</p>
        </div>
    </footer>
</body>
</html>